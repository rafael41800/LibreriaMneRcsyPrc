% Generated by roxygen2: do not edit by hand
% Please edit documentation in
%   R/02_ProcesamientoDeRasterParaAsignarCrs_function.R
\name{ProcessingRasterToAssigneCrs}
\alias{ProcessingRasterToAssigneCrs}
\title{Asignar CRS y procesar raster / Assign CRS and Process Raster}
\usage{
ProcessingRasterToAssigneCrs(RasterObject, SpatialReference)
}
\arguments{
\item{RasterObject}{Objeto raster al que asignaremos coordenadas de
referencia del sistema. Debe ser un objeto \code{SpatRaster} de terra.
/ Raster object to which we will assign coordinate reference system.
Must be a \code{SpatRaster} object from terra.}

\item{SpatialReference}{Referencia espacial de la que tomaremos el CRS.
Puede ser:
/ Spatial reference from which we will take the CRS. Can be:
\itemize{
\item{\strong{Objeto espacial} (\code{sf}, \code{sfc}, \code{SpatVector}) - Se usara su CRS
y se recortara el raster al area del poligono (si es poligono)
/ \strong{Spatial object} (\code{sf}, \code{sfc}, \code{SpatVector}) - Its CRS will
be used and the raster will be cropped to the polygon area
(if it's a polygon)}
\item{\strong{CRS como caracter o numerico} (ej: \code{"EPSG:4326"} o \code{4326}) -
Solo se proyectara el raster al CRS especificado
/ \strong{CRS as character or numeric} (e.g., \code{"EPSG:4326"} or \code{4326}) -
Only raster projection will be applied to the specified CRS}
\item{\strong{Objeto \code{crs}} de terra - CRS directo para la proyeccion
/ \strong{\code{crs} object} from terra - Direct CRS for projection}
}}
}
\value{
Un objeto \code{SpatRaster} procesado con las siguientes caracteristicas:
\itemize{
\item Proyectado al CRS especificado por \code{SpatialReference}
\item Recortado al area del poligono si \code{SpatialReference} es un objeto espacial
de tipo poligono
\item Con valores NA fuera del area del poligono (cuando se aplica recorte)
\item Conservando los metadatos originales cuando es posible
/
A processed \code{SpatRaster} object with the following features:
\item Projected to the CRS specified by \code{SpatialReference}
\item Cropped to the polygon area if \code{SpatialReference} is a polygon-type
spatial object
\item With NA values outside the polygon area (when cropping is applied)
\item Preserving original metadata when possible
}
}
\description{
Asigna un sistema de referencia de coordenadas (CRS) a un raster y
opcionalmente lo recorta a un area espacial definida. La funcion maneja
diferentes tipos de referencia espacial (objetos espaciales, CRS numericos
o textuales) y aplica las transformaciones necesarias.
/
Assigns a coordinate reference system (CRS) to a raster and optionally
crops it to a defined spatial area. The function handles different types
of spatial references (spatial objects, numeric or textual CRS) and
applies necessary transformations.
}
\details{
La funcion realiza las siguientes operaciones en secuencia:
\enumerate{
\item \strong{Configuracion del entorno}: Establece directorio temporal para
manejo eficiente de memoria.
\item \strong{Validacion de entrada}: Verifica que \code{RasterObject} sea un
\code{SpatRaster} valido.
\item \strong{Deteccion de tipo de referencia}: Identifica si \code{SpatialReference} es
un objeto espacial, CRS textual/numerico, o objeto \code{crs}.
\item \strong{Proyeccion}: Transforma el raster al CRS de destino usando
\code{terra::project()}.
\item \strong{Recorte condicional}: Si \code{SpatialReference} es un objeto espacial
con geometria de poligono, aplica \code{terra::crop()} con \code{mask = TRUE}
para recortar y enmascarar simultaneamente.
/
The function performs the following operations in sequence:
\item \strong{Environment setup}: Sets temporary directory for efficient
memory management.
\item \strong{Input validation}: Verifies that \code{RasterObject} is a valid
\code{SpatRaster}.
\item \strong{Reference type detection}: Identifies whether \code{SpatialReference} is
a spatial object, textual/numeric CRS, or \code{crs} object.
\item \strong{Projection}: Transforms the raster to target CRS using
\code{terra::project()}.
\item \strong{Conditional cropping}: If \code{SpatialReference} is a spatial object
with polygon geometry, applies \code{terra::crop()} with \code{mask = TRUE}
to simultaneously crop and mask.
}
}
\note{
\itemize{
\item La funcion utiliza \code{terra::crop()} con \code{mask = TRUE} cuando se proporciona
un poligono, lo que asegura que solo las celdas dentro del poligono sean
retenidas, estableciendo las celdas externas a NA. Esto es mas eficiente
que realizar crop y mask por separado.
\item Para objetos \code{sf} o \code{sfc}, la funcion convierte automaticamente a
\code{SpatVector} para compatibilidad con terra.
\item El parametro \code{mask = TRUE} en \code{terra::crop()} puede ser mas lento para
poligonos muy complejos, pero produce resultados mas precisos.
\item Se recomienda que el raster de entrada tenga un CRS definido para
obtener mejores resultados en la transformacion.
/
\item The function uses \code{terra::crop()} with \code{mask = TRUE} when a polygon is
provided, which ensures that only cells within the polygon are retained,
setting cells outside to NA. This is more efficient than performing
crop and mask separately.
\item For \code{sf} or \code{sfc} objects, the function automatically converts to
\code{SpatVector} for compatibility with terra.
\item The \code{mask = TRUE} parameter in \code{terra::crop()} can be slower for
very complex polygons but produces more accurate results.
\item It is recommended that the input raster has a defined CRS for
better transformation results.
}
}
\section{Advertencias/Warnings}{

\itemize{
\item Si el raster de entrada no tiene CRS definido y se solicita proyeccion,
se asumira WGS84 (EPSG:4326) y se mostrara una advertencia.
\item El recorte con poligonos muy complejos o con muchos agujeros puede
consumir mucha memoria y tiempo de procesamiento.
\item Las transformaciones entre CRS con diferentes elipsoides o datums pueden
introducir pequenas distorsiones.
\item Si el area del poligono esta completamente fuera de la extension del
raster, el resultado sera un raster vacio.
/
\item If the input raster has no defined CRS and projection is requested,
WGS84 (EPSG:4326) will be assumed and a warning will be shown.
\item Cropping with very complex polygons or polygons with many holes may
consume significant memory and processing time.
\item Transformations between CRS with different ellipsoids or datums may
introduce small distortions.
\item If the polygon area is completely outside the raster's extent,
the result will be an empty raster.
}
}

\examples{
\dontrun{
# Ejemplo 1: Proyectar raster usando un CRS numerico
# Example 1: Project raster using a numeric CRS
library(terra)

# Crear un raster de ejemplo
# Create example raster
r <- rast(nrows = 100, ncols = 100, xmin = 0, xmax = 10, ymin = 0, ymax = 10)
values(r) <- runif(ncell(r))

# Proyectar a WGS84 (EPSG:4326)
# Project to WGS84 (EPSG:4326)
raster_proyectado <- ProcessingRasterToAssigneCrs(r, 4326)
print(raster_proyectado)

# Ejemplo 2: Proyectar y recortar usando un poligono sf
# Example 2: Project and crop using an sf polygon
library(sf)

# Crear un poligono de ejemplo en WGS84
# Create example polygon in WGS84
poligono <- st_as_sfc("POLYGON((2 2, 8 2, 8 8, 2 8, 2 2))", crs = 4326)

# Proyectar y recortar el raster
# Project and crop the raster
raster_recortado <- ProcessingRasterToAssigneCrs(r, poligono)
print(raster_recortado)

# Visualizar resultados
# Visualize results
plot(raster_recortado)
plot(st_geometry(poligono), add = TRUE, border = "red", lwd = 2)

# Ejemplo 3: Usar un objeto SpatVector como referencia
# Example 3: Use a SpatVector object as reference
vect_ref <- vect(poligono)
raster_vect <- ProcessingRasterToAssigneCrs(r, vect_ref)
print(raster_vect)

# Ejemplo 4: Usar CRS como texto
# Example 4: Use CRS as text
raster_text <- ProcessingRasterToAssigneCrs(r, "EPSG:4326")
print(raster_text)

# Ejemplo 5: Raster sin CRS definido
# Example 5: Raster without defined CRS
r_sin_crs <- r
crs(r_sin_crs) <- ""  # Eliminar CRS / Remove CRS
raster_sin_crs <- ProcessingRasterToAssigneCrs(r_sin_crs, 4326)
print(raster_sin_crs)
}

}
\seealso{
\itemize{
\item \code{\link[terra]{project}} para transformaciones de sistema de coordenadas de rasters /
\code{\link[terra]{project}} for coordinate system transformations of rasters
\item \code{\link[terra]{crop}} para recortar rasters a areas especificas /
\code{\link[terra]{crop}} for cropping rasters to specific areas
\item \code{\link[terra]{crs}} para manejar sistemas de referencia de coordenadas /
\code{\link[terra]{crs}} for handling coordinate reference systems
\item \code{\link[sf]{st_crs}} para obtener CRS de objetos sf /
\code{\link[sf]{st_crs}} for getting CRS from sf objects
}
}
\concept{funciones_raster, funciones_espaciales, funciones_GIS /
raster_functions, spatial_functions, GIS_functions}
\keyword{CRS,}
\keyword{GIS,}
\keyword{cropping,}
\keyword{espacial,}
\keyword{procesamiento}
\keyword{processing}
\keyword{projection,}
\keyword{proyeccion,}
\keyword{raster,}
\keyword{recorte,}
\keyword{spatial}
