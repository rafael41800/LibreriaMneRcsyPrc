% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04_Simulacion_Pseudoausencias_function.R
\name{Simulate_Pseudoabsences_No_NA_List_Df}
\alias{Simulate_Pseudoabsences_No_NA_List_Df}
\title{Pseudoausencias en base a las presencias, con radio de exclusión / Pseudoabsences Based on Presences, with Exclusion Radius}
\usage{
Simulate_Pseudoabsences_No_NA_List_Df(
  Resultados,
  Raster_CRS_Referencia,
  Objeto_CRS_referencia
)
}
\arguments{
\item{Resultados}{Lista de data frames con presencias por especie, típicamente
generada por la función \code{Presencias_Sf_Sin_Na()}. Cada data frame debe contener:
\itemize{
\item Columnas \code{longitud} y \code{latitud} con coordenadas en grados decimales
\item Columna \code{especievalida} con el identificador de la especie
\item Variables ambientales extraídas del raster para cada ubicación
\item Columna \code{Presencia} con valor \code{1} para todos los registros
/
List of data frames with presences by species, typically generated by
the \code{Presencias_Sf_Sin_Na()} function. Each data frame must contain:
\item \code{longitud} and \code{latitud} columns with coordinates in decimal degrees
\item \code{especievalida} column with species identifier
\item Environmental variables extracted from raster for each location
\item \code{Presencia} column with value \code{1} for all records
}}

\item{Raster_CRS_Referencia}{Objeto \code{SpatRaster} de terra con las variables
ambientales ya proyectadas al sistema de coordenadas de trabajo. Este
raster define:
\itemize{
\item La resolución espacial para la selección de pseudoausencias
\item La extensión geográfica disponible para seleccionar pseudoausencias
\item Los valores ambientales que serán extraídos para las pseudoausencias
/
\code{SpatRaster} object from terra with environmental variables already
projected to the working coordinate system. This raster defines:
\item The spatial resolution for pseudoabsence selection
\item The geographic extent available for pseudoabsence selection
\item Environmental values that will be extracted for pseudoabsences
}}

\item{Objeto_CRS_referencia}{Objeto espacial (\code{sf}, \code{sfc} o \code{SpatVector})
que define el sistema de coordenadas de referencia final para los datos
de salida. También puede ser un CRS en formato EPSG (ej. \code{4326} o
\code{"EPSG:4326"}). Todos los datos serán transformados a este CRS.
/
Spatial object (\code{sf}, \code{sfc} or \code{SpatVector}) defining the final
coordinate reference system for output data. Can also be a CRS in EPSG
format (e.g., \code{4326} or \code{"EPSG:4326"}). All data will be transformed
to this CRS.}
}
\value{
Una lista invisible (no se imprime automáticamente) de objetos \code{sf}, uno por
especie, con las siguientes características:
\itemize{
\item \strong{Presencias originales}: Todos los registros de presencia originales
\item \strong{Pseudoausencias}: Número igual al de presencias (proporción 1:1)
\item \strong{Variables ambientales}: Todos los valores del raster en cada ubicación
\item \strong{Variable respuesta}: Columna \code{Presence} con \code{1} (presencia) y \code{0} (pseudoausencia)
\item \strong{Identificación}: Columna \code{especievalida} con el nombre de la especie
\item \strong{Geometría}: Puntos en el CRS especificado por \code{Objeto_CRS_referencia}
\item \strong{Exclusión espacial}: No se seleccionan pseudoausencias dentro de un radio de
0.1 grados (~11 km en el ecuador) o 10 km (en proyección métrica) de las presencias
}

La lista puede ser asignada a un objeto y luego accedida por nombre de especie.
/
An invisible list (not automatically printed) of \code{sf} objects, one per
species, with the following features:
\itemize{
\item \strong{Original presences}: All original presence records
\item \strong{Pseudoabsences}: Equal number to presences (1:1 proportion)
\item \strong{Environmental variables}: All raster values at each location
\item \strong{Response variable}: \code{Presence} column with \code{1} (presence) and \code{0} (pseudoabsence)
\item \strong{Identification}: \code{especievalida} column with species name
\item \strong{Geometry}: Points in the CRS specified by \code{Objeto_CRS_referencia}
\item \strong{Spatial exclusion}: No pseudoabsences selected within a radius of
0.1 degrees (~11 km at equator) or 10 km (in metric projection) from presences
}

The list can be assigned to an object and then accessed by species name.
}
\description{
Genera pseudoausencias (ausencias simuladas) balanceadas en proporción 1:1
para modelos de nicho ecológico y distribución de especies. La función
aplica un radio de exclusión espacial alrededor de las presencias reales
para evitar seleccionar pseudoausencias en áreas donde es biológicamente
improbable que la especie esté ausente debido a la proximidad con
registros confirmados.
/
Generates balanced pseudoabsences (simulated absences) in 1:1 proportion
for ecological niche modeling and species distribution modeling. The function
applies a spatial exclusion radius around real presences to avoid selecting
pseudoabsences in areas where it is biologically unlikely for the species
to be absent due to proximity to confirmed records.
}
\details{
La función implementa el siguiente algoritmo para cada especie:
\enumerate{
\item \strong{Preparación de datos}:
\itemize{
\item Extrae coordenadas de las presencias
\item Convierte presencias a objeto espacial en el CRS del raster
\item Identifica celdas del raster que contienen presencias
}
\item \strong{Definición de área de exclusión}:
\itemize{
\item Calcula un radio de exclusión basado en el sistema de coordenadas:
\itemize{
\item Para CRS geográficos (grados): 0.1 grados (~11 km)
\item Para CRS proyectados (metros): 10,000 metros (10 km)
}
\item Crea buffers alrededor de cada presencia usando el radio apropiado
}
\item \strong{Selección de pseudoausencias}:
\itemize{
\item Genera todas las celdas del raster dentro de su extensión
\item Elimina celdas que contienen presencias reales
\item Elimina celdas dentro del área de exclusión (buffers)
\item Selecciona aleatoriamente un número de celdas igual al de presencias
}
\item \strong{Extracción de valores ambientales}:
\itemize{
\item Extrae valores de todas las capas del raster para las pseudoausencias
\item Combina con valores de las presencias
}
\item \strong{Transformación y estructuración}:
\itemize{
\item Asigna valores de presencia (1) y pseudoausencia (0)
\item Transforma a CRS final especificado
\item Convierte a objeto \code{sf} con geometrías puntuales
\item Asegura que todas las especies tengan estructura consistente
}
\item \strong{Validación}:
\itemize{
\item Verifica que haya suficientes celdas disponibles para pseudoausencias
\item Emite advertencias para especies con pocas celdas disponibles
\item Excluye especies que no pueden generar pseudoausencias balanceadas
}
}

/
The function implements the following algorithm for each species:
\enumerate{
\item \strong{Data preparation}:
\itemize{
\item Extracts coordinates from presences
\item Converts presences to spatial object in raster's CRS
\item Identifies raster cells containing presences
}
\item \strong{Exclusion area definition}:
\itemize{
\item Calculates exclusion radius based on coordinate system:
\itemize{
\item For geographic CRS (degrees): 0.1 degrees (~11 km)
\item For projected CRS (meters): 10,000 meters (10 km)
}
\item Creates buffers around each presence using appropriate radius
}
\item \strong{Pseudoabsence selection}:
\itemize{
\item Generates all raster cells within the raster extent
\item Removes cells containing real presences
\item Removes cells within exclusion area (buffers)
\item Randomly selects number of cells equal to presences
}
\item \strong{Environmental value extraction}:
\itemize{
\item Extracts values from all raster layers for pseudoabsences
\item Combines with presence values
}
\item \strong{Transformation and structuring}:
\itemize{
\item Assigns presence (1) and pseudoabsence (0) values
\item Transforms to final specified CRS
\item Converts to \code{sf} object with point geometries
\item Ensures all species have consistent structure
}
\item \strong{Validation}:
\itemize{
\item Verifies sufficient cells available for pseudoabsences
\item Issues warnings for species with few available cells
\item Excludes species that cannot generate balanced pseudoabsences
}
}
}
\note{
\itemize{
\item La proporción 1:1 (presencia:pseudoausencia) es común en modelado de
distribución de especies, pero puede ajustarse manualmente si es necesario.
\item El radio de exclusión (0.1° o 10 km) está basado en recomendaciones
estándar para evitar sobreajuste espacial en los modelos.
\item Las pseudoausencias se seleccionan aleatoriamente, por lo que diferentes
ejecuciones pueden producir resultados distintos. Use \code{set.seed()} para
reproducibilidad.
\item La función maneja automáticamente la diferencia entre sistemas de
coordenadas geográficas (grados) y proyectadas (metros).
\item Especies con muchas presencias y/o raster de alta resolución pueden
requerir tiempo de procesamiento significativo.
/
\item The 1:1 proportion (presence:pseudoabsence) is common in species
distribution modeling but can be manually adjusted if needed.
\item The exclusion radius (0.1° or 10 km) is based on standard recommendations
to avoid spatial overfitting in models.
\item Pseudoabsences are randomly selected, so different runs may produce
different results. Use \code{set.seed()} for reproducibility.
\item The function automatically handles differences between geographic
(degrees) and projected (meters) coordinate systems.
\item Species with many presences and/or high-resolution rasters may require
significant processing time.
}
}
\section{Advertencias/Warnings}{

\itemize{
\item \strong{Disponibilidad de celdas}: Si hay más presencias que celdas disponibles
después de aplicar la exclusión, la función reducirá proporcionalmente
las pseudoausencias y emitirá una advertencia.
\item \strong{Área de estudio pequeña}: En áreas geográficas pequeñas o con muchas
presencias, puede haber muy pocas celdas disponibles para pseudoausencias.
\item \strong{Resolución del raster}: Rasters de muy alta resolución (celdas pequeñas)
pueden hacer que el proceso de exclusión sea muy estricto, limitando las
opciones de pseudoausencias.
\item \strong{Transformación de CRS}: La doble transformación (presencias → raster CRS →
CRS final) puede introducir pequeñas imprecisiones en las coordenadas.
\item \strong{Memoria}: Para rasters grandes con muchas especies, el proceso puede
consumir mucha memoria al generar todas las celdas posibles.
/
\item \strong{Cell availability}: If there are more presences than available cells
after applying exclusion, the function will proportionally reduce
pseudoabsences and issue a warning.
\item \strong{Small study area}: In small geographic areas or with many presences,
there may be very few cells available for pseudoabsences.
\item \strong{Raster resolution}: Very high-resolution rasters (small cells) can
make the exclusion process very strict, limiting pseudoabsence options.
\item \strong{CRS transformation}: Double transformation (presences → raster CRS →
final CRS) may introduce small inaccuracies in coordinates.
\item \strong{Memory}: For large rasters with many species, the process may consume
significant memory when generating all possible cells.
}
}

\examples{
\dontrun{
# Ejemplo 1: Uso básico después de generar presencias
# Example 1: Basic usage after generating presences

# Primero generar presencias sin NA
# First generate presences without NA
Subsets_Df_Presencias_Sin_Na <- Presencias_Sf_Sin_Na(
  Data_Sf = datos_presencia_sf,
  raster_referencia_reproyectado = raster_ambiental,
  Especie_Valida = "especie"
)

# Luego generar pseudoausencias balanceadas
# Then generate balanced pseudoabsences
pseudoausencias <- Simular_Pseudoausencias_Sin_NA(
  Resultados = Subsets_Df_Presencias_Sin_Na,
  Raster_CRS_Referencia = Raster_Tif_reproyectado,
  Objeto_CRS_referencia = Oax_sf
)

# Acceder a datos de una especie específica
# Access data for a specific species
especie_1 <- pseudoausencias[["NombreEspecie1"]]

# Verificar proporción presencia/pseudoausencia
# Check presence/pseudoabsence proportion
table(especie_1$Presence)

# Visualizar resultados
# Visualize results
plot(st_geometry(especie_1),
     col = ifelse(especie_1$Presence == 1, "red", "blue"),
     pch = 16, cex = 0.7)

# Ejemplo 2: Con semilla para reproducibilidad
# Example 2: With seed for reproducibility
set.seed(123)
pseudoausencias_repro <- Simular_Pseudoausencias_Sin_NA(
  Resultados = Subsets_Df_Presencias_Sin_Na,
  Raster_CRS_Referencia = raster_ambiental,
  Objeto_CRS_referencia = 4326  # CRS como número EPSG / CRS as EPSG number
)

# Ejemplo 3: Análisis de todas las especies
# Example 3: Analysis of all species
resumen_especies <- data.frame(
  Especie = names(pseudoausencias),
  n_Presencias = sapply(pseudoausencias, function(x) sum(x$Presence == 1)),
  n_Pseudoausencias = sapply(pseudoausencias, function(x) sum(x$Presence == 0))
)
print(resumen_especies)
}

}
\seealso{
\itemize{
\item \code{\link[=Presencias_Sf_Sin_Na]{Presencias_Sf_Sin_Na()}} para generar los datos de entrada requeridos
/ to generate required input data
\item \code{\link[terra:extract]{terra::extract()}} para extraer valores de raster en puntos
/ to extract raster values at points
\item \code{\link[sf:geos_unary]{sf::st_buffer()}} para crear áreas de exclusión alrededor de puntos
/ to create exclusion areas around points
\item \code{\link[=set.seed]{set.seed()}} para establecer semilla y resultados reproducibles
/ to set seed for reproducible results
}
}
